<md-content id="bodyContent">
  <div id="anchorButtonRow" layout="row" style="overflow-x: scroll">
    <span flex></span>
    <div id="anchorButtonContainer" ng-repeat="(projectName, projectPersons) in projectsWithPersons">
      <md-button ng-click="goToSectionHeader(projectName)" aria-label="Go to {{projectName}}">
        <span class="md-subhead anchor-button-text" style="font-size:14px">{{ (projectName == 'all') ? 'Unassigned' : projectName | titlecase }}</span>
        <span class="md-subhead anchor-button-text" style="font-weight:bold; font-size:14px">({{ numCheckedIn[projectName]}})</span>
      </md-button>
    </div>
    <span flex></span>
  </div>

  <md-subheader class="md-no-sticky" ng-hide="Object.keys(van).length < 1">Vans</md-subheader>
  <md-list class="personsList" ng-hide="Object.keys(van).length < 1">
    <div id="vansContainer" ng-repeat="(vanId, vanInfo) in vans">
      <md-list-item class="md-2-line listAnimate" layout="row" layout-align="start center">
        <div layout="row" flex="100">
          <div flex="30" class="md-list-item-text">
            <h3>{{ vanInfo.name }}</h3>
            <p>{{projectSites[vanInfo.assignedToSite].name}}</p>
          </div>
          <div flex="70" class="iconSetContainer" layout="row" layout-align="start cetner">
            <div flex class="listIconContainer" layout-align="start center">
              <div ng-show="(vanInfo.driver_person_id != null && vanInfo.driver_person_id != '') && persons[vanInfo.driver_person_id].isCheckedIn == 1">
                <md-button aria-label="Manage driver" class="md-accent md-hue-1" ng-click="vanControlPanel(vanInfo.driver_person_id, vanId)" style="padding:0 !important; min-width:40px !important">
                  <md-icon id="listButtonIcon" md-svg-src="app/images/icons/steeringWheel.svg"></md-icon>
                </md-button>
              </div>
              <div ng-hide="(vanInfo.driver_person_id != null && vanInfo.driver_person_id != '') && persons[vanInfo.driver_person_id].isCheckedIn == 1">
                <md-button ng-hide="" aria-label="Select driver" ng-click="assignVanDriver(vanId, vanInfo.assignedToSite)" style="padding:0 !important; min-width:40px !important">
                  <md-icon id="listButtonIcon" md-svg-src="app/images/icons/steeringWheel.svg"></md-icon>
                </md-button>
              </div>
              <div>
                <span ng-show="(vanInfo.driver_person_id != null && vanInfo.driver_person_id != '')">{{ persons[vanInfo.driver_person_id].firstName }} {{ persons[vanInfo.driver_person_id].lastName }}</span>
              </div>
            </div>
          </div> <!--end listIconSetContainer -->
        </div>
      </md-list-item>
    </div> <!-- end #vansContainer -->

    <md-divider ng-hide="Object.keys(vans).length < 1"></md-divider>
    <md-subheader class="md-no-sticky">Volunteer Cars</md-subheader>
    <div id="teerCarsContainer" ng-repeat="(teerCarId, teerCarInfo) in teerCars">
      <md-list-item class="md-2-line listAnimate" layout="row" layout-align="start center">
        <div flex="30" class="md-list-item-text">
          <h3>Volunteer Car</h3>
          <p>{{projectSites[teerCarInfo.assignedToSite].name}}</p>
        </div>
        <div flex="70" class="iconSetContainer" layout="row" layout-align="start cetner">
          <div flex class="listIconContainer" layout-align="start center">
            <div ng-show="(teerCarInfo.driver_person_id != null && teerCarInfo.driver_person_id != '') && persons[teerCarInfo.driver_person_id].driverStatus == 'isTeerCarDriver' && persons[teerCarInfo.driver_person_id].isCheckedIn == 1">
              <md-button aria-label="Manage driver" class="md-accent md-hue-1" ng-click="teerCarControlPanel(teerCarInfo.driver_person_id, teerCarId)" style="padding:0 !important; min-width:40px !important">
                <md-icon id="listButtonIcon" md-svg-src="app/images/icons/steeringWheel.svg"></md-icon>
              </md-button>
              <span>{{ persons[teerCarInfo.driver_person_id].firstName }} {{ persons[teerCarInfo.driver_person_id].lastName }}</span>
            </div>
            <div ng-hide="(teerCarInfo.driver_person_id != null && teerCarInfo.driver_person_id != '') && persons[teerCarInfo.driver_person_id].driverStatus == 'isTeerCarDriver' && persons[teerCarInfo.driver_person_id].isCheckedIn == 1">
              <md-button ng-hide="" aria-label="Select driver" ng-click="assignTeerCarDriver(teerCarId, teerCarInfo.assignedToSite)" style="padding:0 !important; min-width:40px !important">
                <md-icon id="listButtonIcon" md-svg-src="app/images/icons/steeringWheel.svg"></md-icon>
              </md-button>
            </div>
          </div>
        </div> <!--end listIconSetContainer -->
      </md-list-item>
    </div> <!-- end #teerCarContainer -->


    <div ng-repeat="(projectName, projectPersons) in projectsWithPersons">
      <div id="{{projectName}}Header" ng-show="numCheckedIn[projectName] > 0">
        <md-divider ng-hide="$first"></md-divider>
        <p class="md-body-2 secondary-text-opacity" style="margin-top:10px; margin-bottom:0; padding-left:16px">{{ (projectName == 'all') ? 'Not Assigned' : projectName | titlecase }}</p>
      </div>
      <div ng-repeat="person in projectPersons | orderByLastName:persons" class="listAnimate">
        <md-list-item class="md-2-line listAnimate" layout="row" layout-align="center center" ng-show="persons[person].firstName.length > 0" ng-mouseenter="showMoreIcon[person] = true" ng-mouseleave="showMoreIcon[person] = false" on-long-press="regInfoEdit(person)">
          <div layout="row" layout-align="start center" flex="100">
            <md-button class="md-icon-button" ng-show="!screenIsSmall && !screenIsXsmall && showMoreIcon[person]" style="margin-left:0; padding-left:0" ng-click="regInfoEdit(person)">
              <md-icon>more_vert</md-icon>
            </md-button>
            <!-- <div layout="row"> -->
              <div class="">
                <span>{{persons[person].firstName}} {{persons[person].lastName}}</span>
              </div>
              <div flex="" class="iconSetContainer" layout="row" layout-align="start cetner">
                <div flex class="listIconContainer" layout-align="end center" ng-show="persons[person].hasCar == 1 || (persons[person].driverStatus != null && persons[person].driverStatus != '')">
                  <div id="switchContainer" ng-hide="screenIsXsmall || screenIsSmall || persons[person].hasCar == 0 || persons[person].driverStatus == 'isTeerCarDriver' || persons[person].driverStatus == 'isVanDriver'" ng-repeat="v in [0]"> <!--workaround proper display of switch-->
                    <md-switch ng-model="persons[person].driverStatus" ng-true-value="'isDriver'" ng-false-value="null" ng-change="updateDriverStatus(person)" ng-disabled="(persons[person].assignedToDriver_id != null && persons[person].assignedToDriver_id != '' && persons[person].assignedToDriver_id != 0)" aria-label="Driver Active" style="margin-left:0"></md-switch>
                  </div>
                  <div id="driverControlButtonsContainer" ng-hide="persons[person].hasCar == 0 || persons[person].driverStatus == 'isTeerCarDriver' || persons[person].driverStatus == 'isVanDriver'" layout="row">
                    <md-button aria-label="Manage driver" ng-disabled="!(persons[person].driverStatus == 'isDriver' || persons[person].driverStatus == 'isTeerCarDriver' || persons[person].driverStatus == 'isVanDriver') && (persons[person].assignedToDriver_id != null && persons[person].assignedToDriver_id != '' && persons[person].assignedToDriver_id != 0) && !screenIsSmall && !screenIsXsmall" ng-class="{'md-accent md-hue-1': persons[person].driverStatus == 'isDriver' || persons[person].driverStatus == 'isVanDriver' || persons[person].driverStatus == 'isTeerCarDriver'}" ng-click="driverControlPanel(person)" style="padding:0 !important; min-width:40px !important">
                      <md-icon id="listButtonIcon" md-svg-src="app/images/icons/steeringWheel.svg"></md-icon>
                    </md-button>
                  </div>
                  <div id="teerCarDriverControlButtonsContainer" ng-if="persons[person].driverStatus == 'isTeerCarDriver'">
                    <md-button aria-label="Manage driver" ng-class="{'md-accent md-hue-1': persons[person].driverStatus == 'isTeerCarDriver'}" ng-click="teerCarControlPanel(person, getTeerCarDrivenBy(person))" style="padding:0 !important; min-width:40px !important">
                      <md-icon id="listButtonIcon" md-svg-src="app/images/icons/steeringWheel.svg"></md-icon>
                    </md-button>
                  </div>
                  <div id="vanDriverControlButtonsContainer" ng-if="persons[person].driverStatus == 'isVanDriver'">
                    <md-button aria-label="Manage driver" ng-class="{'md-accent md-hue-1': persons[person].driverStatus == 'isVanDriver'}" ng-click="vanControlPanel(person, getVanDrivenBy(person))" style="padding:0 !important; min-width:40px !important">
                      <md-icon id="listButtonIcon" md-svg-src="app/images/icons/steeringWheel.svg"></md-icon>
                    </md-button>
                  </div>
                </div>
                <div flex class="listIconContainer" layout-align="center center">
                  <md-button ng-hide="persons[person].driverStatus == 'isDriver' || persons[person].driverStatus == 'isTeerCarDriver' || persons[person].driverStatus == 'isVanDriver'" aria-label="Assign driver" class="md-icon-button" ng-class="{'md-primary md-hue-1': persons[person].assignedToDriver_id != null && persons[person].assignedToDriver_id != 0}" ng-click="assignDriver(person)" style="padding:0 !important">
                    <!--TODO ng-show to have assignedProject show if exists and preferredProject if not-->
                    <md-icon id="listButtonIcon" class="material-icons" aria-label="car">drive_eta</md-icon>
                  </md-button>
                </div>
                <div id="speedDialContainer" flex="" class="listIconContainer" layout="row" layout-align="end center" style="" ng-class="{'fab-button-workaround': projectName != 'all'}">
                  <md-fab-speed-dial id="speedDial" flex ng-if="projectName == 'all'" class="md-fling" md-direction="left" md-open="false" ng-cloak style="height:100%; top: 5px">
                    <md-fab-trigger>
                      <md-button aria-label="menu" class="md-fab speedDialButton md-primary">
                        <md-icon class="material-icons.md-18" style="color:white;">assignment_turned_in</md-icon>
                      </md-button>
                    </md-fab-trigger>
                    <div>
                      <md-fab-actions>
                        <md-button aria-label="Paint" id="speedDialActionButton_first" ng-click="checkInPerson(person, 'paint', projectName)" class="md-fab md-raised md-mini md-primary md-hue-1 speedDialButton" ng-disabled="!activePaintSites">
                          <md-icon class="sitc-icon-" style="color:white;" aria-label="Paint">paint</md-icon>
                        </md-button>
                        <md-button aria-label="Plant" id="speedDialActionButton_second" ng-click="checkInPerson(person, 'plant', projectName)" class="md-fab md-raised md-mini md-primary md-hue-1 speedDialButton" ng-disabled="!activePlantSites">
                          <md-icon class="sitc-icon-" style="color:white;" aria-label="Plant">plant</md-icon>
                        </md-button>
                        <md-button aria-label="Play" id="speedDialActionButton_third" ng-click="checkInPerson(person, 'play', projectName)" class="md-fab md-raised md-mini md-primary md-hue-1 speedDialButton" ng-disabled="!activePlaySites">
                          <md-icon class="sitc-icon-" style="color:white;" aria-label="Play">play</md-icon>
                        </md-button>
                      </md-fab-actions>
                    </div> <!--speed dial actions container-->
                  </md-fab-speed-dial>
                  <md-button ng-if="projectName != 'all'" aria-label="menu" class="md-fab speedDialButton md-primary"  ng-click="checkInPerson(person, projectName, projectName, false)"> <!--instead of speedDial if project is already set-->
                    <md-icon class="sitc-icon-" style="color:white;">{{ persons[person].assignedToProject}}</md-icon>
                  </md-button>
                </div>
              </div> <!--end listIconSetContainer -->
            <!-- </div> -->
          </div>
        </md-list-item>
      </div>
    </div>
  </md-list>
</md-content>
